(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{33:function(e,t,n){},34:function(e,t,n){},37:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(27),s=n.n(c),o=n(13),i=(n(33),n(12)),u=n(5),l=(n(34),n(17)),d=n(10),h=n(2),j=function(e){return Object(h.jsxs)("div",{className:"header",children:[Object(h.jsx)("h1",{children:"Chat App"}),e.children]})},b=n(18),p=Object(a.createContext)(null),f=function(e){var t=e.children;return b.a.apps.length||b.a.initializeApp({apiKey:"AIzaSyB7Vzr9T9fjvL8QWyR3Gko8ku3RJvWxMDQ",authDomain:"chatapp-2604c.firebaseapp.com",databaseURL:"https://chatapp-2604c-default-rtdb.europe-west1.firebasedatabase.app",projectId:"chatapp-2604c",storageBucket:"chatapp-2604c.appspot.com",messagingSenderId:"438557718193",appId:"1:438557718193:web:784da41c914dfa6b811490",measurementId:"G-H614FWZQB1"}),Object(h.jsx)(p.Provider,{value:b.a,children:t})},g=(n(22),function(e){var t=Object(a.useContext)(p),n=Object(a.useState)({email:"",password:"",error:""}),r=Object(i.a)(n,2),c=r[0],s=r[1],o=function(){t.auth().signInWithEmailAndPassword(c.email,c.password).then((function(t){e.history.push("/")})).catch((function(e){console.log(e),"auth/user-not-found"===e.code?t.auth().createUserWithEmailAndPassword(c.email,c.password).then((function(e){return console.log(e)})).catch((function(e){console.log(e),s((function(e){return Object(d.a)(Object(d.a)({},e),{},{error:"Error signing up."})}))})):s((function(e){return Object(d.a)(Object(d.a)({},e),{},{error:"Error logging in"})}))}))},u=function(e){var t=e.target,n=t.name,a=t.value;s((function(e){return Object(d.a)(Object(d.a)({},e),{},Object(l.a)({},n,a))}))};return Object(h.jsxs)("div",{className:"login-container",children:[Object(h.jsx)(j,{}),Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault(),s((function(e){return Object(d.a)(Object(d.a)({},e),{},{error:""})})),c.email&&c.password?o():s((function(e){return Object(d.a)(Object(d.a)({},e),{},{error:"Please fill in both field."})}))},children:[Object(h.jsx)("p",{children:"Please, log in into the app. Or make a new account by entering your email and password."}),Object(h.jsx)("input",{type:"text",name:"email",placeholder:"Please, enter your username",onChange:u,value:c.username}),Object(h.jsx)("input",{type:"password",name:"password",placeholder:"Please, enter your password.",onChange:u,value:c.password}),Object(h.jsx)("p",{className:"login-container__error",children:c.error}),Object(h.jsx)("button",{type:"submit",children:"Login"})]})]})}),m=(n(37),function(e){var t=Object(a.useContext)(p),n=Object(a.useState)(""),r=Object(i.a)(n,2),c=r[0],s=r[1],u=Object(a.useRef)(),l=Object(a.useRef)(),d=Object(a.useRef)(void 0),b=function(){d.current&&(d.scrollTop=d.scrollHeight)};Object(a.useEffect)((function(){u.current?l.length!==e.messages.length&&b():(b(),u.current=!0,l.current=e.messages,console.log("compomentDidMount"))}),[e.messages]);var f=function(e,t){if(!t||t.author!==e.author)return Object(h.jsx)("p",{className:"author",children:Object(h.jsx)(o.b,{to:"/users/".concat(e.user_id),children:e.author})})},g=function(){e.onSubmit(c),s("")};return Object(h.jsxs)("div",{className:"chat-container",children:[Object(h.jsx)(j,{children:Object(h.jsx)("button",{onClick:function(){t.auth().signOut()},children:"Logout"})}),e.messagesLoaded?Object(h.jsx)("div",{className:"message-container",ref:function(e){return d=e},children:e.messages.map((function(t,n){return Object(h.jsxs)("div",{className:"message ".concat(e.user.email===t.author&&"mine"),children:[Object(h.jsx)("p",{children:t.msg}),f(t,e.messages[n+1])]},t.id)}))}):Object(h.jsx)("div",{className:"loading-container",children:Object(h.jsx)("h4",{children:"Loading messages, please wait!"})}),Object(h.jsxs)("div",{className:"chat-input",children:[Object(h.jsx)("textarea",{placeholder:"Add your message",value:c,onChange:function(e){var t=e.target.value;s(t)},onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),g())}}),Object(h.jsx)("button",{onClick:g,children:"SEND"})]})]})}),O=function(e){var t=!1,n=function(e){if(!t)return t=!0,Object(h.jsx)("p",{className:"author",children:e})};return Object(h.jsxs)("div",{className:"user-container",children:[Object(h.jsx)(j,{children:Object(h.jsx)(o.b,{to:"/",children:Object(h.jsx)("button",{children:"Back To Chat"})})}),e.messagesLoaded?Object(h.jsx)("div",{className:"messages-container",children:e.messages.map((function(t){if(t.user_id===e.userID)return Object(h.jsxs)("div",{className:"message",children:[n(t.author),Object(h.jsx)("p",{children:t.msg})]},t.id)}))}):Object(h.jsx)("h2",{children:"Loading messages, please wait!"})]})};n(42);var v=Object(u.e)((function(e){var t=Object(a.useState)([]),n=Object(i.a)(t,2),r=n[0],c=n[1],s=Object(a.useState)(null),o=Object(i.a)(s,2),l=o[0],d=o[1],j=Object(a.useState)(!1),b=Object(i.a)(j,2),f=b[0],v=b[1],x=Object(a.useContext)(p),w=function(e){var t={msg:e,author:l.email,user_id:l.uid,timestamp:Date.now()};x.database().ref("messages/").push(t)};return Object(a.useEffect)((function(){x.auth().onAuthStateChanged((function(t){t?(d(t),console.log(t)):e.history.push("/login")})),x.database().ref("/messages").on("value",(function(e){!function(e){var t=Object.keys(e.val()).map((function(t){var n=e.val()[t];return n.id=t,n}));c(t)}(e)})),f||v(!0)}),[]),Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(u.a,{path:"/login",component:g}),Object(h.jsx)(u.a,{exact:!0,path:"/",render:function(){return Object(h.jsx)(m,{messagesLoaded:f,onSubmit:w,user:l,messages:r})}}),Object(h.jsx)(u.a,{path:"/users/:id",render:function(e){e.history;var t=e.match;return Object(h.jsx)(O,{messages:r,messagesLoaded:f,userID:t.params.id})}})]})})),x=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function w(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,47)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};s.a.render(Object(h.jsx)(f,{children:Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(o.a,{children:Object(h.jsx)(v,{})})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/src/service-worker.js")})),"serviceWorker"in navigator){if(new URL("/chat-app",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/chat-app","/service-worker.js");x?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):w(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):w(t,e)}))}}(),k()}},[[46,1,2]]]);
//# sourceMappingURL=main.7c969682.chunk.js.map